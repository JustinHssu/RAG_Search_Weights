# RAG 論文 - 數據增強

此文件旨在定義一套數據增強方式，根據不同的需求，對原始問題進行多層次的加工，生成多種變化的問題，以測試 RAG 系統對不同形式問題的檢索準確率

## 資料格式說明

輸入：JSON 檔案，包含以下欄位：
- `qid`: 問題編號
- `question`: 問題本身

輸出：增強後的問題集 JSON，包含以下欄位：
- `qid`: 此問題的唯一編號
- `parentqid`: 對應的原始問題編號
- `tagone`: 第一層分解問題的方式
- `tagtwo`: 第二層分解問題的方式（若無需進行第二層分解，則此欄位留空）
- `question`: 問題本身

---

## Original Question
我會給定一份 txt, 裡面有大量法律條文的 unstructure 文字，你要用 textsplitter 切割文字，然後為每一 chunk 做出題, 所以如果有 n 個 chunk, 會產生 n 個問題
- **tagone**: "originalquestion"
- tagtwo 為 ""

## 數據增強方式 (基於上述 n 個問題做數據增強)

### 1. 問題換同義詞
- **tagone**: "questionSynonymChange"
- **描述**: 將問題中的關鍵字提取出來，並將其替換為同義詞，保持語意不變。
- **意義**: 提升檢索準確度，讓 RAG 系統先將關鍵字替換成知識庫內的同義詞再進行檢索。
- **func**: “擴5倍”  
- **倍數**: 5 倍

---

### 2. 問題隨知識style
- **tagone**: "questionWithKnowledgeStyle"
- **描述**: 從知識中隨機抽取三筆，讓 LLM 改寫問題，使其符合知識的風格，如法律嚴謹、隨性風格或程式碼格式等。
- **意義**: 增加 RAG 系統對多樣化知識表達的適應性。
- **func**: 無 (tagtwo 為 "")
- **倍數**: 1 倍

---

### 3. 複合問題 x2
- **tagone**: "complexQuestionX2"
- **描述**: 將一個知識領域下的多個問題進行兩兩組合，產生出語意較複雜的複合問題。
- **意義**: 模擬實際情境中用戶提出的複合問題，提高 RAG 對語意複雜問題的處理能力。
- **func**: “擴5倍”  
- **倍數**: 5 倍

---

### 4. 複合問題 x3
- **tagone**: "complexQuestionX3"
- **描述**: 將一個知識領域下的多個問題進行三三組合，產生出更複雜的問題。
- **意義**: 增強對更高語意複雜度問題的處理，檢測 keyword 檢索在複合語意下的適用性。
- **func**: “擴5倍”
- **倍數**: 5 倍

---

### 5. 問題 + 關鍵字
- **tagone**: "questionWithKeyword"
- **描述**: 從原問題中提取出關鍵字，並將關鍵字附加在問題之後。
- **意義**: 提升不使用 hybrid search 時的檢索效果。
- **func**: 無 (tagtwo 為 "")
- **倍數**: 1 倍

---

### 6. 問題 + 同義詞
- **tagone**: "questionWithSynonym"
- **描述**: 將原問題中的關鍵字替換為同義詞，並附加在問題之後。
- **意義**: 提升不使用 hybrid search 時的檢索效果。
- **func**: 無 (tagtwo 為 "")
- **倍數**: 1 倍

---

### 7. 問題 + 關鍵字 + 同義詞
- **tagone**: "questionWithKeywordAndSynonym"
- **描述**: 將原問題提取出關鍵字，並附加同義詞於問題之後。
- **意義**: 提升不使用 hybrid search 時的檢索效果。
- **func**: 無 (tagtwo 為 "")
- **倍數**: 1 倍

---

## func: 擴5倍

**定義**: 對每個問題進行數據增強，產生 5 個不同變體。

### 增強方式
1. 原始問題 (完全不改變) | **tagtwo**: "originalq"
2. 改變句型：在不改變語意的前提下，調換主詞和動詞位置 | **tagtwo**: "changeSentenceStructure"
3. 濃縮語意表達：使用最精簡的文字 | **tagtwo**: "condensedSemanticExpression"
4. 濃縮後的句型變化：用濃縮後的句子，在不影響語意的情況下，改變句型，例如把主詞動詞的位置做調換 | **tagtwo**: "condensedandChange"
5. 提取出關鍵字：用空格分開 | **tagtwo**: "extractKeywords"

---

## 增強計算與總結

| 問題類別            | 倍數 |
|---------------------|------|
| 問題換同義詞       | 5    |
| 問題隨知識style    | 1    |
| 複合問題x2         | 5    |
| 複合問題x3         | 5    |
| 問題+關鍵字        | 1    |
| 問題+同義詞        | 1    |
| 問題+關鍵字+同義詞 | 1    |

- **總增強倍數**: 每個原問題的倍數合計 = 19 倍
